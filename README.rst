CAM4 ensemble reanalysis using DART
===================================

Publication
-----------

A comprehensive description of this dataset has been published as:

Raeder, K., J. L. Anderson, N. Collins, T. J. Hoar, J. E. Kay, P. H. Lauritzen, and R. Pincus, 2012: DART/CAM: An Ensemble Data Assimilation System for CESM Atmospheric Models. J. Climate, 25, 6304-6317 (DOI: 10.1175/JCLI-D-11-00395.1).

Overview
--------
DAReS created a global 80-member ensemble reanalysis using the finite-volume Community Atmosphere Model. This dataset was generated to provide ensembles of atmospheric forcing (from CAM4) to ocean assimilations (using POP) and has also been used to force land model assimilations using CLM4.0.

:CAM Version: 4.0.1
:Levels: 26 vertical levels
:Resolution: Nominal 2-degree grid
:Observations: All the observations that were used in the NCEP/NCAR Reanalysis
:Output Frequency: 6-hourly resolution
:Date Range: 01-Dec-1997 through 31-Dec-2010

The full dataset is many Tb's of data and is stored on the `NCAR/UCAR High Performance Storage System (HPSS) <https://www2.cisl.ucar.edu/resources/storage-and-file-systems/hpss>`__. The data atmosphere surface fields can be used to force other components of the `Community Earth System Model <http://www2.cesm.ucar.edu/>`__ (CESM) are approximately 1.5 Tb of data and are available via NCAR's `Research Data Archive <https://rda.ucar.edu/datasets/ds199.1>`__.

The POP_force dataset was generated to provide ensembles of atmospheric forcing (from CAM4) to ocean assimilations (using POP). They have also been used to force land model assimilations (using CLM4.0). There are several data products, which are described in detail below:

#. State space output from DART
#. Observation space output from DART
#. CAM initial files, and CLM, CICE, and DART restart files.
#. "Stream files", which are the data source from which the coupler imported atmospheric forcing for use by other components in CCSM (circa 2011).
#. Observation space diagnostics.

Overall Structure of Data Set 
-----------------------------

All of the data sets are on NCAR's HPSS in ``hpss:/home/raeder/RAEDER/DAI/POP_force``. This location will be shortened to **{hpss}** for the remainder of the document.

There are several separate assimilations named *POP*\ **yy**, where **yy** = 12,15,74,79,84,89, or 94. 12 and 15 both refer to multiyear assimilations that jointly cover 1997/12/1 - 2010/12/31. 74,79,84,89,94 refer to years 1974, 1979, etc.

In each *POPyy* directory there is a series of directories named *obs_####*, where #### refers to the day within the assimilation series (padded with leading zeros).

- 0001,...,0365 for assimilations 74,79,84,89,94
- 0001,...,4779 for assimilations 12,15, as given by the `DOY Table`_ below.

In each *obs_####* directory there is a DART diagnostics file named *diagnostics.tar.gz* and some have CAM+DART restart file sets.

1. State-Space Diagnostics
--------------------------

``obs_####/diagnostics.tar.gz`` has DART output: Prior_Diag.nc; Inflated prior ensemble of state vectors ('copy's 3,...,82) at hours 6Z, 12Z, 18Z, 24Z. Also contains the ensemble mean (copy 1) and spread(2), and inflation(83) and inflation standard deviation(84). The state vector is PS, T, US, VS, Q, CLDLIQ, and CLDICE. Posterior_Diag.nc; Same, but for not-inflated posterior ensemble.

2. Observation-Space Datasets and Diagnostics
---------------------------------------------

Observation-Space Data
  ``obs_####/diagnostics.tar.gz`` also has DART output obs_seq.final; The observations available for assimilation and the ensemble of estimates of those obs. These files can be plotted using DART's Matlab scripts. The observations consist of T, U, and V from the NCEP BUFR files: radiosondes, ACARS, AIRCRAFT, and satellite drift winds (no surface obs). After 2006 they also used radio occultation observations from COSMIC GPS satellites.

Observation-Space Diagnostics
  Time series and vertical profiles of statistics of the ensemble estimates of the observations can be found in ``{hpss}/POP15/YYYY_Mon_obs_diag.gztar`` where ``YYYY = 2000,...,2010`` and ``Mon = Jan, Feb, ...``. These were generated by ``${DARTROOT}/diagnostics/matlab/plot_rmse_xxx_evolution.m`` and  ``${DARTROOT}/diagnostics/matlab/plot_rmse_xxx_profile.m`` with 'totalspread' and 'bias' passed in the argument lists. The statistics are calculated for the northern and southern extratropics, the tropics, and North America.

3. CESM CAM Restart Datasets
----------------------------

Some ``obs_####`` have 'restart sets' in 80xEM/batchN, EM = number of ensemble members/file, (80 members total) N = 1,2,... Each of these files contains the CAM initial files, and CLM, CICE, and DART restart files for EM ensemble members. The CAM initial files contain the posterior model state at the end of the day represented by ####. These are slightly out of balance due to the perturbations introduced by the last assimilation. An example script, ``hpss2restart.csh``, is available for downloading and unpacking these files. You must have an account on the HPSS for this method.

4. 'Data Atmosphere' Stream Files for CESM Experiments
------------------------------------------------------

"Stream files", which are the data source from which the coupler imported atmospheric forcing for use by other components in CCSM (circa 2011). 1 member and 1 year/file. 48 exist. Up to 80 could be made.
``{hpss}/POPyy/Forcing_YYYY/ FV2deg_Cplr_out_single-POP15-EM.cpl.ha2x1d.gztar`` where ``YYYY = 2000,...,2010`` and ``EM = 1,...,48``. 

These contain files:
FV2deg_Cplr_out_single-POP15-EM.cpl.ha2x1davg.2000.nc: 365 time slots: daily
FV2deg_Cplr_out_single-POP15-EM.cpl.ha2x1dx6h.2000.nc: 1460 time slots: 4/day

Those files were constructed from contents of ``{hpss}/POP15/cplr_forcing_YYYY_Mon.gztar`` where ``YYYY = 2000,...,2010`` and ``Mon = Jan, Feb...`` which contain files:
``6hourly/FV2deg_Cplr_out_single-POP15-EM.cpl.ha2x1dx6h.2000-4.nc``
``daily/FV2deg_Cplr_out_single-POP15-EM.cpl.ha2x1davg.2000-4.nc``

where ``EM = 1,...,80``. These are intermediate (monthly) files between what was written by CAM/cpl (6 hourly) and what was needed by other component assimilations (yearly).

The original files can be found in:

``{hpss}/POPyy/obs_####/H_cplr.ha2x1d.gz.tar`` where ``####`` and ``yy`` are as above.

DOY Table
---------
